# üîó SRV-SYS INTEGRATION SYSTEM v1.0

> **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `/srv/sys/`**
> 
> –ê–≤—Ç–æ—Ä: Sandrick Tech | –î–∞—Ç–∞: 2024-12-09 | –í–µ—Ä—Å–∏—è: 1.0

---

## üìñ –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã)
4. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
5. [–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](#–ø–æ–¥—Ä–æ–±–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)
6. [API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#api-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
7. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
8. [Troubleshooting](#troubleshooting)

---

## üéØ –í–í–ï–î–ï–ù–ò–ï

### –ß—Ç–æ —ç—Ç–æ?

**SRV-SYS Integration System** ‚Äî —ç—Ç–æ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É `/srv/sys/`.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** ‚Äî –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ–≥–æ  
‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** ‚Äî –æ–¥–∏–Ω —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã  
‚úÖ **Service Discovery** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤  
‚úÖ **Health Monitoring** ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã  
‚úÖ **–ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π  
‚úÖ **Hooks System** ‚Äî —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —Ö—É–∫–æ–≤  

### –î–ª—è –∫–æ–≥–æ?

- üîß **DevOps –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- üõ°Ô∏è **–°–∏—Å—Ç–µ–º–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤** ‚Äî —É–ø—Ä–æ—â–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- üë®‚Äçüíª **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** ‚Äî –±—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π
- üè¢ **IT –æ—Ç–¥–µ–ª–æ–≤** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
/srv/sys/                                # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îÇ
‚îú‚îÄ‚îÄ manifest.json                        # –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã (Service Registry)
‚îú‚îÄ‚îÄ srv-sys-master.conf                  # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
‚îÇ
‚îú‚îÄ‚îÄ configs/                             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf                   # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ Nginx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sites-available/             # –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∞–π—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sites-enabled/               # –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–∞–π—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ snippets/                    # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ mysql/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ custom.cnf                   # –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ MySQL
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ postgresql/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ custom.conf                  # –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ PostgreSQL
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ redis/
‚îÇ   ‚îú‚îÄ‚îÄ mongodb/
‚îÇ   ‚îú‚îÄ‚îÄ fail2ban/
‚îÇ   ‚îî‚îÄ‚îÄ ssh/
‚îÇ
‚îú‚îÄ‚îÄ iptables/                            # –ü—Ä–∞–≤–∏–ª–∞ firewall
‚îÇ   ‚îú‚îÄ‚îÄ v4/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00-base.v4                   # –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 10-ssh.v4                    # SSH –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 20-web.v4                    # HTTP/HTTPS –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ combined.v4                  # –°–æ–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ v6/
‚îÇ       ‚îî‚îÄ‚îÄ combined.v6
‚îÇ
‚îú‚îÄ‚îÄ systemd/                             # systemd units
‚îÇ   ‚îî‚îÄ‚îÄ system/
‚îÇ       ‚îú‚îÄ‚îÄ iptables-restore.service     # –ê–≤—Ç–æ–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ iptables
‚îÇ       ‚îú‚îÄ‚îÄ ssh-session@.service         # SID –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ       ‚îî‚îÄ‚îÄ srv-sys-sync.service         # –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ ssh/                                 # SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ win_config/                      # Windows SSH –∫–æ–Ω—Ñ–∏–≥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config                       # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.d/                    # –ú–æ–¥—É–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ ssh_session/                     # SID –ª–æ–≥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ active/                      # –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ archive/                     # –ê—Ä—Ö–∏–≤ —Å–µ—Å—Å–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metadata/                    # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ sshd_config.d/                   # sshd –∫–æ–Ω—Ñ–∏–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ authorized_keys/                 # SSH –∫–ª—é—á–∏
‚îÇ
‚îú‚îÄ‚îÄ backups/                             # –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ iptables/
‚îÇ   ‚îî‚îÄ‚îÄ ssh/
‚îÇ
‚îú‚îÄ‚îÄ scripts/                             # –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ iptables-controller.sh           # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä iptables
‚îÇ   ‚îú‚îÄ‚îÄ ssh-sid-system.sh                # SID —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ win-config.sh                    # Win_Config –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ security-hardening.sh            # –ú–æ–¥—É–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ deploy/                          # –°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è
‚îÇ   ‚îú‚îÄ‚îÄ maintenance/                     # –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/                      # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚îÇ
‚îú‚îÄ‚îÄ logs/                                # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
‚îÇ   ‚îú‚îÄ‚îÄ integrator.log                   # –õ–æ–≥–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ changes.log                      # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ audit.log                        # –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ nginx-access.log
‚îÇ   ‚îú‚îÄ‚îÄ nginx-error.log
‚îÇ   ‚îú‚îÄ‚îÄ mysql-error.log
‚îÇ   ‚îî‚îÄ‚îÄ postgresql.log
‚îÇ
‚îî‚îÄ‚îÄ hooks/                               # –°–∏—Å—Ç–µ–º–∞ —Ö—É–∫–æ–≤
    ‚îú‚îÄ‚îÄ pre-deploy/
    ‚îÇ   ‚îî‚îÄ‚îÄ 00-backup.sh                 # Backup –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
    ‚îÇ
    ‚îú‚îÄ‚îÄ post-deploy/
    ‚îÇ   ‚îî‚îÄ‚îÄ 00-reload.sh                 # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
    ‚îÇ
    ‚îú‚îÄ‚îÄ pre-update/
    ‚îî‚îÄ‚îÄ post-update/
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

#### 1. **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏—Å—Ç–∏–Ω—ã**
–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `srv-sys-master.conf`, –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–∏—Ç–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç—Ç—É–¥–∞.

#### 2. **Service Registry**
–§–∞–π–ª `manifest.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
```json
{
  "version": "1.0",
  "components": {
    "iptables": {"enabled": true, "version": "1.8.7"},
    "nginx": {"enabled": true, "port": 80},
    "mysql": {"enabled": true, "port": 3306}
  }
}
```

#### 3. **–ê–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**
–ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–∞ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç:
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 4. **–ê–≤—Ç–æ–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
```bash
# SID —Å–∏—Å—Ç–µ–º–∞ —É–∑–Ω–∞—ë—Ç SSH –ø–æ—Ä—Ç –∏–∑ iptables
SSH_PORT=$(jq -r '.components.ssh.port' /srv/sys/manifest.json)

# Win_Config –Ω–∞—Ö–æ–¥–∏—Ç gate-—Å–µ—Ä–≤–µ—Ä
GATE_IP=$(jq -r '.components.ssh.gate_ip' /srv/sys/manifest.json)
```

---

## üß© –ö–û–ú–ü–û–ù–ï–ù–¢–´ –°–ò–°–¢–ï–ú–´

### 1. srv-sys-integrator.sh

**–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä** –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- Health checks
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü–æ–ª–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
./srv-sys-integrator.sh --init

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
./srv-sys-integrator.sh --check

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞
./srv-sys-integrator.sh --report

# –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
./srv-sys-integrator.sh --backup

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
./srv-sys-integrator.sh
```

### 2. srv-sys-master.conf

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª** —Å 600+ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:**
- –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- SSH –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- iptables –ø—Ä–∞–≤–∏–ª–∞
- –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
- Nginx, MySQL, PostgreSQL, Redis
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Docker –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –≤ —Å–∫—Ä–∏–ø—Ç–µ
source /srv/sys/srv-sys-master.conf

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
echo "SSH –ø–æ—Ä—Ç: $SRV_SYS_SSH_PORT"
echo "Nginx –∫–æ–Ω—Ñ–∏–≥: $SRV_SYS_CONFIGS_NGINX"
```

### 3. manifest.json

**Service Registry** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- –í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ö–æ—Å—Ç–µ
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—ç–∫–∞–ø–æ–≤
- –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "version": "1.0",
  "system": {
    "hostname": "web-server-01",
    "ip_address": "192.168.1.100"
  },
  "components": {
    "nginx": {
      "enabled": true,
      "config_path": "/srv/sys/configs/nginx",
      "port": 80
    }
  }
}
```

### 4. iptables-controller.sh

–ú–æ–¥—É–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ firewall —á–µ—Ä–µ–∑ `/srv/sys/iptables/`.

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å SSH –∫–æ–Ω—Ñ–∏–≥–æ–º
- Hooks –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

### 5. ssh-sid-system.sh

–°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ SSH —Å–µ—Å—Å–∏–π.

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ß–∏—Ç–∞–µ—Ç SSH –ø–æ—Ä—Ç –∏–∑ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
- –£–≤–µ–¥–æ–º–ª—è–µ—Ç iptables –æ –Ω–æ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å Win_Config

### 6. win-config-automation.sh

–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–æ–Ω—Ñ–∏–≥–æ–≤.

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ gate-—Å–µ—Ä–≤–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç—ã –∏–∑ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å SID —Å–∏—Å—Ç–µ–º–æ–π

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã
cp srv-sys-integrator.sh /root/
cp srv-sys-master.conf /root/

# –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x /root/srv-sys-integrator.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
cd /root
./srv-sys-integrator.sh --init
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë              SRV-SYS INTEGRATOR v1.0                              ‚ïë
‚ïë          –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

[‚Üí] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π /srv/sys/
[‚úì] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω–∞

[‚Üí] –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
[‚úì] –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Å–æ–∑–¥–∞–Ω: /srv/sys/manifest.json

[‚Üí] –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
[‚úì]   –û–±–Ω–∞—Ä—É–∂–µ–Ω: nginx
[‚úì]   –û–±–Ω–∞—Ä—É–∂–µ–Ω: mysql
[‚úì]   –û–±–Ω–∞—Ä—É–∂–µ–Ω: iptables
[‚òÖ] –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Å–µ—Ä–≤–∏—Å–æ–≤: 3

[‚Üí] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
[‚úì] iptables –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
[‚úì] SID —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞
[‚úì] Win_Config –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

[‚Üí] –ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
[‚úì] Nginx –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω
[‚úì] MySQL –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω

[‚Üí] –°–æ–∑–¥–∞–Ω–∏–µ —Ö—É–∫–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
[‚úì] –•—É–∫–∏ —Å–æ–∑–¥–∞–Ω—ã

[‚Üí] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
[‚úì]   Nginx –∫–æ–Ω—Ñ–∏–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
[‚úì]   MySQL –∫–æ–Ω—Ñ–∏–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
[‚òÖ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

[‚Üí] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
[‚úì]   ‚úì iptables IPv4 –ø—Ä–∞–≤–∏–ª–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
[‚úì]   ‚úì ssh-session@.service —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
[‚òÖ] –°–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤–∞, –ø—Ä–æ–±–ª–µ–º –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

[‚òÖ] –ü–æ–ª–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
ls -la /srv/sys/

# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç
cat /srv/sys/manifest.json

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ health check
./srv-sys-integrator.sh --check
```

### –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
./srv-sys-integrator.sh

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é
cd /srv/sys/scripts/
./iptables-controller.sh
./ssh-sid-system.sh
./win-config.sh
```

---

## üìö –ü–û–î–†–û–ë–ù–û–ï –†–£–ö–û–í–û–î–°–¢–í–û

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–∞—Å—Ç–µ—Ä-–∫–æ–Ω—Ñ–∏–≥
nano /srv/sys/srv-sys-master.conf

# –ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
SRV_SYS_SSH_PORT="2222"
SRV_SYS_NGINX_WORKER_PROCESSES="4"

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ
./srv-sys-integrator.sh --sync
```

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

```bash
# 1. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª
echo 'SRV_SYS_CUSTOM_SERVICE_ENABLED="true"' >> /srv/sys/srv-sys-master.conf
echo 'SRV_SYS_CUSTOM_SERVICE_PORT="9999"' >> /srv/sys/srv-sys-master.conf

# 2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∫–æ–Ω—Ñ–∏–≥–∞
mkdir -p /srv/sys/configs/custom_service/

# 3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
jq '.components.custom_service = {"enabled": true, "port": 9999}' \
   /srv/sys/manifest.json > /tmp/manifest.json
mv /tmp/manifest.json /srv/sys/manifest.json

# 4. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç –≤ iptables
/srv/sys/scripts/iptables-controller.sh
# –í—ã–±–µ—Ä–∏—Ç–µ: Add Custom Service ‚Üí –í–≤–µ–¥–∏—Ç–µ 9999
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### –ü—Ä–∏–º–µ—Ä: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Nginx —Å iptables

```bash
# 1. Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ /srv/sys/configs/nginx/
# 2. iptables –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç—ã 80 –∏ 443
# 3. Fail2Ban —á–∏—Ç–∞–µ—Ç –ª–æ–≥–∏ –∏–∑ /srv/sys/logs/nginx-*.log
# 4. –ë—ç–∫–∞–ø—ã –≤–∫–ª—é—á–∞—é—Ç –∫–æ–Ω—Ñ–∏–≥–∏ Nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
./srv-sys-integrator.sh --check
```

#### –ü—Ä–∏–º–µ—Ä: SSH —Å SID –∏ Win_Config

```bash
# 1. SSH —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É –∏–∑ $SRV_SYS_SSH_PORT
# 2. iptables –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ—Ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# 3. SID –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —Å–µ—Å—Å–∏–∏ –≤ /srv/sys/ssh/ssh_session/
# 4. Win_Config –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è Windows –∫–ª–∏–µ–Ω—Ç–æ–≤

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
cat /srv/sys/manifest.json | jq '.components.ssh'
ls /srv/sys/ssh/ssh_session/active/
cat /srv/sys/ssh/win_config/config
```

### Hooks System

#### –°–æ–∑–¥–∞–Ω–∏–µ pre-deploy —Ö—É–∫–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç
cat > /srv/sys/hooks/pre-deploy/10-validate.sh <<'EOF'
#!/bin/bash
echo "[$(date)] Pre-deploy: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Nginx
if [[ -f /srv/sys/configs/nginx/nginx.conf ]]; then
    nginx -t -c /srv/sys/configs/nginx/nginx.conf || exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º iptables
if [[ -f /srv/sys/iptables/v4/combined.v4 ]]; then
    iptables-restore --test < /srv/sys/iptables/v4/combined.v4 || exit 1
fi

echo "[$(date)] Pre-deploy: –≤–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞"
EOF

# –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x /srv/sys/hooks/pre-deploy/10-validate.sh
```

#### –°–æ–∑–¥–∞–Ω–∏–µ post-update —Ö—É–∫–∞

```bash
cat > /srv/sys/hooks/post-update/10-notify.sh <<'EOF'
#!/bin/bash
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

# Telegram
if [[ "$SRV_SYS_NOTIFY_TELEGRAM_ENABLED" == "true" ]]; then
    curl -s -X POST \
        "https://api.telegram.org/bot$SRV_SYS_NOTIFY_TELEGRAM_BOT_TOKEN/sendMessage" \
        -d "chat_id=$SRV_SYS_NOTIFY_TELEGRAM_CHAT_ID" \
        -d "text=‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: $(hostname)"
fi

# Email
if [[ "$SRV_SYS_NOTIFY_EMAIL_ENABLED" == "true" ]]; then
    echo "–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: $(hostname)" | \
        mail -s "SRV-SYS Update Complete" "$SRV_SYS_NOTIFY_EMAIL_TO"
fi
EOF

chmod +x /srv/sys/hooks/post-update/10-notify.sh
```

### –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø

```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ –º–∞—Å—Ç–µ—Ä-–∫–æ–Ω—Ñ–∏–≥–µ
SRV_SYS_BACKUPS_ENABLED="true"
SRV_SYS_BACKUPS_RETENTION_DAYS="30"
SRV_SYS_BACKUPS_SCHEDULE="0 2 * * *"  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00

# –°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á—É
cat > /etc/cron.d/srv-sys-backup <<'EOF'
0 2 * * * root /root/srv-sys-integrator.sh --backup
EOF
```

#### –†—É—á–Ω–æ–π –±—ç–∫–∞–ø

```bash
# –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø
./srv-sys-integrator.sh --backup

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# /srv/sys/backups/srv-sys-backup-20241209_140530.tar.gz
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
cd /
tar -xzf /srv/sys/backups/srv-sys-backup-YYYYMMDD_HHMMSS.tar.gz

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
./srv-sys-integrator.sh --sync
```

---

## üîå API –ò–ù–¢–ï–ì–†–ê–¶–ò–ò

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤

#### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏—Å—Ç–µ–º–µ

```bash
#!/bin/bash
# –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –º–∞—Å—Ç–µ—Ä-–∫–æ–Ω—Ñ–∏–≥
if [[ -f /srv/sys/srv-sys-master.conf ]]; then
    source /srv/sys/srv-sys-master.conf
else
    echo "–û—à–∏–±–∫–∞: –º–∞—Å—Ç–µ—Ä-–∫–æ–Ω—Ñ–∏–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    exit 1
fi

# 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
echo "SSH –ø–æ—Ä—Ç: $SRV_SYS_SSH_PORT"
echo "Nginx –∫–æ–Ω—Ñ–∏–≥: $SRV_SYS_CONFIGS_NGINX"

# 3. –ß–∏—Ç–∞–π—Ç–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç —á–µ—Ä–µ–∑ jq
if command -v jq &>/dev/null; then
    NGINX_ENABLED=$(jq -r '.components.nginx.enabled' "$SRV_SYS_MANIFEST")
    echo "Nginx –≤–∫–ª—é—á—ë–Ω: $NGINX_ENABLED"
fi
```

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ

```bash
#!/bin/bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

COMPONENT_NAME="my_service"
COMPONENT_PORT="9999"

# –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç
jq --arg name "$COMPONENT_NAME" \
   --arg port "$COMPONENT_PORT" \
   '.components[$name] = {"enabled": true, "port": $port | tonumber}' \
   /srv/sys/manifest.json > /tmp/manifest.json

mv /tmp/manifest.json /srv/sys/manifest.json

echo "–ö–æ–º–ø–æ–Ω–µ–Ω—Ç $COMPONENT_NAME –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
#!/bin/bash
source /srv/sys/srv-sys-master.conf

# –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
log_to_srv_sys() {
    local level="$1"
    local message="$2"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    echo "[$timestamp] [$level] $message" >> "$SRV_SYS_LOGS/my_script.log"
}

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
log_to_srv_sys "INFO" "–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω"
log_to_srv_sys "ERROR" "–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"
```

#### –í—ã–∑–æ–≤ —Ö—É–∫–æ–≤

```bash
#!/bin/bash

# –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ö—É–∫–æ–≤
run_hooks() {
    local hook_type="$1"  # pre-deploy | post-deploy | etc
    
    for hook in /srv/sys/hooks/$hook_type/*.sh; do
        if [[ -f "$hook" && -x "$hook" ]]; then
            echo "–í—ã–ø–æ–ª–Ω—è–µ–º —Ö—É–∫: $(basename "$hook")"
            "$hook" || {
                echo "–û—à–∏–±–∫–∞ –≤ —Ö—É–∫–µ: $hook"
                return 1
            }
        fi
    done
}

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
run_hooks "pre-deploy"
# ... –≤–∞—à –∫–æ–¥ –¥–µ–ø–ª–æ—è ...
run_hooks "post-deploy"
```

---

## üí° –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –ö–µ–π—Å 1: –î–µ–ø–ª–æ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
#!/bin/bash
# deploy_webapp.sh - –î–µ–ø–ª–æ–π —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

source /srv/sys/srv-sys-master.conf

APP_NAME="my_webapp"
APP_PORT="8080"

# 1. Pre-deploy —Ö—É–∫–∏ (–∞–≤—Ç–æ–±—ç–∫–∞–ø)
run_hooks "pre-deploy"

# 2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
jq --arg app "$APP_NAME" \
   --arg port "$APP_PORT" \
   '.services[$app] = {"port": $port | tonumber, "status": "deploying"}' \
   "$SRV_SYS_MANIFEST" > /tmp/manifest.json
mv /tmp/manifest.json "$SRV_SYS_MANIFEST"

# 3. –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç –≤ iptables
echo "–û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç $APP_PORT..."
/srv/sys/scripts/iptables-controller.sh --add-port "$APP_PORT" --tcp --service "$APP_NAME"

# 4. –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ñ–∏–≥ Nginx
cat > "$SRV_SYS_CONFIGS_NGINX/sites-available/$APP_NAME.conf" <<EOF
server {
    listen 80;
    server_name $APP_NAME.example.com;
    
    location / {
        proxy_pass http://localhost:$APP_PORT;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
    }
}
EOF

# 5. –í–∫–ª—é—á–∞–µ–º —Å–∞–π—Ç
ln -sf "$SRV_SYS_CONFIGS_NGINX/sites-available/$APP_NAME.conf" \
       "$SRV_SYS_CONFIGS_NGINX/sites-enabled/"

# 6. –¢–µ—Å—Ç–∏—Ä—É–µ–º Nginx
nginx -t && systemctl reload nginx

# 7. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
jq --arg app "$APP_NAME" \
   '.services[$app].status = "running"' \
   "$SRV_SYS_MANIFEST" > /tmp/manifest.json
mv /tmp/manifest.json "$SRV_SYS_MANIFEST"

# 8. Post-deploy —Ö—É–∫–∏ (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
run_hooks "post-deploy"

echo "‚úì –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ $APP_NAME –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ"
```

### –ö–µ–π—Å 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH Gate

```bash
#!/bin/bash
# setup_ssh_gate.sh

source /srv/sys/srv-sys-master.conf

GATE_USER="gate"
GATE_PORT="22"

# 1. –í–∫–ª—é—á–∞–µ–º Gate –≤ –∫–æ–Ω—Ñ–∏–≥–µ
sed -i 's/SRV_SYS_SSH_GATE_ENABLED="false"/SRV_SYS_SSH_GATE_ENABLED="true"/' \
    "$SRV_SYS_BASE/srv-sys-master.conf"

# 2. –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç
jq '.components.ssh.gate_enabled = true | 
    .components.ssh.gate_user = "'"$GATE_USER"'" | 
    .components.ssh.gate_port = '"$GATE_PORT"'' \
   "$SRV_SYS_MANIFEST" > /tmp/manifest.json
mv /tmp/manifest.json "$SRV_SYS_MANIFEST"

# 3. –°–æ–∑–¥–∞—ë–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
useradd -m -s /bin/bash "$GATE_USER"
mkdir -p /home/$GATE_USER/.ssh
chmod 700 /home/$GATE_USER/.ssh

# 4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SSH –∫–ª—é—á–∏
ssh-keygen -t ed25519 -f /home/$GATE_USER/.ssh/id_ed25519 -N ""
chown -R $GATE_USER:$GATE_USER /home/$GATE_USER/.ssh

# 5. –û–±–Ω–æ–≤–ª—è–µ–º Win_Config
/srv/sys/scripts/win-config.sh --regenerate

echo "‚úì SSH Gate –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
echo "Public key:"
cat /home/$GATE_USER/.ssh/id_ed25519.pub
```

### –ö–µ–π—Å 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

```bash
#!/bin/bash
# monitor_system.sh

source /srv/sys/srv-sys-master.conf

# –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
send_telegram() {
    local message="$1"
    
    if [[ "$SRV_SYS_NOTIFY_TELEGRAM_ENABLED" == "true" ]]; then
        curl -s -X POST \
            "https://api.telegram.org/bot$SRV_SYS_NOTIFY_TELEGRAM_BOT_TOKEN/sendMessage" \
            -d "chat_id=$SRV_SYS_NOTIFY_TELEGRAM_CHAT_ID" \
            -d "text=$message" \
            -d "parse_mode=HTML"
    fi
}

# Health check
if ! /root/srv-sys-integrator.sh --check &>/dev/null; then
    send_telegram "üî¥ <b>–ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ $(hostname)</b>%0A%0AHealth check failed!"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
DISK_USAGE=$(df -h /srv/sys | awk 'NR==2 {print $5}' | sed 's/%//')
if [[ $DISK_USAGE -gt 80 ]]; then
    send_telegram "‚ö†Ô∏è <b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</b>%0A%0A/srv/sys/ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${DISK_USAGE}%"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH —Å–µ—Å—Å–∏–π
ACTIVE_SESSIONS=$(ls /srv/sys/ssh/ssh_session/active/ | wc -l)
if [[ $ACTIVE_SESSIONS -gt 10 ]]; then
    send_telegram "‚ö†Ô∏è <b>–ú–Ω–æ–≥–æ SSH —Å–µ—Å—Å–∏–π</b>%0A%0A–ê–∫—Ç–∏–≤–Ω—ã—Ö: $ACTIVE_SESSIONS"
fi

send_telegram "‚úÖ <b>–°–∏—Å—Ç–µ–º–∞ –≤ –Ω–æ—Ä–º–µ</b>%0A%0A$(hostname) - OK"
```

---

## üîß TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∞–Ω–∏—Ñ–µ—Å—Ç –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```bash
./srv-sys-integrator.sh --init
# –û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å manifest.json
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
ls -la /srv/sys/
sudo chown -R root:root /srv/sys/
sudo chmod 755 /srv/sys/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
df -h /srv/

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ jq —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
apt install -y jq  # Debian/Ubuntu
yum install -y jq  # CentOS/RHEL
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```bash
[!] iptables –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
[!] SID —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ /root/
cp srv-sys-iptables-controller.sh /root/
cp ssh-sid-system.sh /root/
cp win-config-automation.sh /root/
cp security-hardening-advanced.sh /root/

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ
./srv-sys-integrator.sh --init
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
```bash
./srv-sys-integrator.sh --sync
# –ö–æ–Ω—Ñ–∏–≥–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏
ls -la /etc/nginx/nginx.conf.d/
ls -la /etc/mysql/conf.d/

# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
mkdir -p /etc/nginx/conf.d/
mkdir -p /etc/mysql/conf.d/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
chmod 644 /srv/sys/configs/nginx/nginx.conf
chmod 644 /srv/sys/configs/mysql/custom.cnf
```

### –ü—Ä–æ–±–ª–µ–º–∞: Health check fails

**–°–∏–º–ø—Ç–æ–º—ã:**
```bash
./srv-sys-integrator.sh --check
[!] –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º: 5
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
./srv-sys-integrator.sh --check --verbose

# –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
# –ü—Ä–∏–º–µ—Ä: iptables –ø—Ä–∞–≤–∏–ª–∞
if [[ ! -f /srv/sys/iptables/v4/combined.v4 ]]; then
    /srv/sys/scripts/iptables-controller.sh --generate
fi

# –ü—Ä–∏–º–µ—Ä: systemd units
if [[ ! -f /srv/sys/systemd/system/ssh-session@.service ]]; then
    cp /root/ssh-session@.service /srv/sys/systemd/system/
    systemctl daemon-reload
fi
```

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç
./srv-sys-integrator.sh --report

# –í—ã–≤–æ–¥:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
SRV-SYS SYSTEM REPORT
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: 2024-12-09 14:30:00
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–°–ò–°–¢–ï–ú–ê:
  Hostname: web-server-01
  IP Address: 192.168.1.100
  OS: Ubuntu 22.04.3 LTS
  Kernel: 5.15.0-91-generic
  Uptime: up 10 days, 5 hours

–ö–û–ú–ü–û–ù–ï–ù–¢–´:
  iptables: true
  nginx: true
  mysql: true
  ssh: true
  sid: true

–°–ï–†–í–ò–°–´:
  nginx.service - running
  mysql.service - running
  ssh.service - running

IPTABLES:
  IPv4 –ø—Ä–∞–≤–∏–ª: 47
  IPv6 –ø—Ä–∞–≤–∏–ª: 15

SSH –°–ï–°–°–ò–ò:
  –ê–∫—Ç–∏–≤–Ω—ã—Ö: 2
  –ê—Ä—Ö–∏–≤–Ω—ã—Ö: 158

–†–ï–ó–ï–†–í–ù–´–ï –ö–û–ü–ò–ò:
  –ü–æ—Å–ª–µ–¥–Ω—è—è: srv-sys-backup-20241209_020001.tar.gz

–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –î–ò–°–ö–ê:
  245M  /srv/sys
```

### –õ–æ–≥–∏

```bash
# –õ–æ–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–∞
tail -f /srv/sys/logs/integrator.log

# –õ–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π
tail -f /srv/sys/logs/changes.log

# –ê—É–¥–∏—Ç
tail -f /srv/sys/logs/audit.log
```

---

## üéì BEST PRACTICES

### 1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
SSH_PORT="2222"  # –•–∞—Ä–¥–∫–æ–¥ –≤ —Å–∫—Ä–∏–ø—Ç–µ
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
source /srv/sys/srv-sys-master.conf
SSH_PORT="$SRV_SYS_SSH_PORT"
```

### 2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Redis
apt install -y redis-server
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Redis
apt install -y redis-server

# –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
jq '.components.redis.enabled = true' \
   /srv/sys/manifest.json > /tmp/manifest.json
mv /tmp/manifest.json /srv/sys/manifest.json
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö—É–∫–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
# –í—Ä—É—á–Ω—É—é –¥–µ–ª–∞–µ–º –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
tar -czf backup.tar.gz /srv/sys/configs/
# –î–µ–ø–ª–æ–π...
# –í—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã
systemctl reload nginx
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
# –•—É–∫–∏ –¥–µ–ª–∞—é—Ç –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
run_hooks "pre-deploy"   # –ê–≤—Ç–æ–±—ç–∫–∞–ø
# –î–µ–ø–ª–æ–π...
run_hooks "post-deploy"  # –ê–≤—Ç–æ—Ä–µ–ª–æ–∞–¥
```

### 4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
./my_script.sh
# –ù–∞–¥–µ–µ–º—Å—è —á—Ç–æ –≤—Å—ë –û–ö
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```bash
./my_script.sh
./srv-sys-integrator.sh --check || {
    echo "–û—à–∏–±–∫–∞! –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è..."
    restore_from_backup
}
```

---

## üìñ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- **README_V5.md** ‚Äî –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç v5.0 Enhanced Edition
- **HISTOR_IMPLEMENTATION.md** ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è HISTOR —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- **SECURITY_INTEGRATION_GUIDE.md** ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **README_SSH_GATE.md** ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH Gate
- **ADMIN_GUIDE_V2.md** ‚Äî –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## ü§ù –ü–û–î–î–ï–†–ñ–ö–ê

–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `/srv/sys/help/`
- –õ–æ–≥–∏: `/srv/sys/logs/`
- Health check: `./srv-sys-integrator.sh --check`

---

**¬© 2024 Sandrick Tech | SRV-SYS Integration System v1.0**
